@model CuaHangThietBiDienTu.Models.SanPham
@{
    ViewBag.Title = "Chi tiết sản phẩm";
}

<h2>Chi tiết sản phẩm</h2>
<div class="row border-2 shadow-sm p-3 rounded-4 bg-white">
    <div class="col-lg-4 rounded-4 ">
        <img src="~/Content/Images/ProductImg/@Model.HinhAnh" class="w-100" />
        <div class="row">
            @foreach (var anh in Model.HINHANHs)
            {
                <div class="col-lg-3">
                    <img src="" style="width: 100%;">
                </div>
            }
        </div>
    </div>
    <div class="col-lg-8">
        <h3>@Model.TenSP</h3>
        <p class="fs-4 fw-bold text-danger">@Model.GiaBan</p>
        <p>@Model.MoTa</p>
        <div class="row g-3 text-bottom">
            <div class="col-lg-6">
                <a href="#" class="btn btn-warning">Thêm vào giỏ</a>
            </div>
            <div class="col-lg-6">
                <a href="#" class="btn btn-secondary">Quay lại</a>
            </div>
        </div>
    </div>


</div>

<div class="comment mt-4">
    <h4>Đánh giá</h4>

    @if (ViewBag.Cmt != null && ((List<CuaHangThietBiDienTu.Models.DanhGia>)ViewBag.Cmt).Any())
    {
        foreach (var bl in (List<CuaHangThietBiDienTu.Models.DanhGia>)ViewBag.Cmt)
        {
            <div class="p-2 mb-2 rounded-3 bg-white" style="border: 2px solid #b7f0f8">
                <p><strong>@bl.NguoiDung.HoTen</strong> - @bl.NgayDanhGia.Value.ToString("dd/MM/yyyy")</p>
                <p>
                    Đánh giá:
                    @for (int i = 1; i <= 5; i++)
                    {
                        if (i <= bl.Rate)
                        {
                            <text><span class="text-warning">&#9733;</span></text>
                        }
                        else
                        {
                            <text><span class="text-muted">&#9734;</span></text>
                        }
                    }
                </p>
                <p>@bl.NoiDung</p>
            </div>
        }
    }
    else
    {
        <p>Chưa có bình luận nào.</p>
    }

    @if (Session["UserID"] != null)
    {
        using (Html.BeginForm("Comment", "SanPhams", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            @Html.Hidden("maSP", Model.MaSP)
            <div class="p-3">
                <div class="mb-3">
                    <label>Nội dung bình luận</label>
                    <textarea name="noiDung" class="form-control" style="width:100% !important;" rows="3" required></textarea>
                </div>

                <div class="mb-3">
                    <label>Đánh giá</label>
                    <select name="rate" class="form-select" required>
                        <option value="">Chọn đánh giá</option>
                        @for (int i = 1; i <= 5; i++)
                        {
                            <option value="@i" class="w-100">@i sao</option>
                        }
                    </select>
                </div>

                <button type="submit" class="btn btn-primary">Gửi bình luận</button>
            </div>

           
        }
    }
    else
    {
        <p class="text-end"><a href="@Url.Action("Login", "Account")" class="btn btn-primary ">Đăng nhập</a> để bình luận sản phẩm.</p>
    }
</div>

<div class="row mt-5">
    @if (ViewBag.SPLQ != null)
    {
        <h3>Sản phẩm liên quan</h3>
        <div class="row">
            @foreach (var sp in ViewBag.SPLQ)
            {

                <div class="col-md-4 mb-3">
                    <div class="card text-center h-100 rounded-4 shadow-sm">
                        <div class="p-3">
                            <img src="~/Content/Images/ProductImg/@sp.HinhAnh" class="rounded-4" style="width: 100%; max-height: 250px; object-fit:cover;" alt="...">

                        </div>
                        <div class="card-body">
                            <h5 class="card-title">@sp.TenSP</h5>
                            <p class="card-text text-danger fw-bold">@sp.GiaBan.ToString("N0")</p>
                            <a href="@Url.Action("ChiTietSP", "SanPhams", new {maSP = sp.MaSP})" class="btn btn-primary">Xem chi tiết</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

